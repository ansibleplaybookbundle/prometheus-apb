FROM ansibleplaybookbundle/apb-base

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY plugins /opt/ansible/plugins
COPY ansible.cfg /etc/ansible/
RUN chmod -R g=u /opt/{ansible,apb}
USER apb

LABEL "com.redhat.apb.version"="1.3.0"
LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMC4wCm5hbWU6IHByb21ldGhldXMtYXBiCmRlc2NyaXB0aW9uOiBEZXBs\
b3kgUHJvbWV0aGV1cyBvbiB5b3VyIFByb2plY3QKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRp\
b25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogUHJvbWV0aGV1cyAoQVBCKQogIGltYWdlVXJs\
OiBodHRwczovL2F2YXRhcnMxLmdpdGh1YnVzZXJjb250ZW50LmNvbS91LzMzODA0NjI/cz0yMDAm\
dj00CiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiBQcm9tZXRoZXVzIGlzIGFuIG9wZW4tc291cmNlIHN5c3RlbXMgbW9uaXRvcmluZyBhbmQg\
YWxlcnRpbmcgdG9vbGtpdCBvcmlnaW5hbGx5IGJ1aWx0IGF0IFNvdW5kQ2xvdWQuIFNpbmNlIGl0\
cyBpbmNlcHRpb24gaW4gMjAxMiwgbWFueSBjb21wYW5pZXMgYW5kIG9yZ2FuaXphdGlvbnMgaGF2\
ZSBhZG9wdGVkIFByb21ldGhldXMsIGFuZCB0aGUgcHJvamVjdCBoYXMgYSB2ZXJ5IGFjdGl2ZSBk\
ZXZlbG9wZXIgYW5kIHVzZXIgY29tbXVuaXR5LiBJdCBpcyBub3cgYSBzdGFuZGFsb25lIG9wZW4g\
c291cmNlIHByb2plY3QgYW5kIG1haW50YWluZWQgaW5kZXBlbmRlbnRseSBvZiBhbnkgY29tcGFu\
eS4gVG8gZW1waGFzaXplIHRoaXMsIGFuZCB0byBjbGFyaWZ5IHRoZSBwcm9qZWN0J3MgZ292ZXJu\
YW5jZSBzdHJ1Y3R1cmUsIFByb21ldGhldXMgam9pbmVkIHRoZSBDbG91ZCBOYXRpdmUgQ29tcHV0\
aW5nIEZvdW5kYXRpb24gaW4gMjAxNiBhcyB0aGUgc2Vjb25kIGhvc3RlZCBwcm9qZWN0LCBhZnRl\
ciBLdWJlcm5ldGVzLgogIHNlcnZpY2VOYW1lOiBwcm9tZXRoZXVzCnBsYW5zOgogIC0gbmFtZTog\
ZXBoZW1lcmFsCiAgICBkZXNjcmlwdGlvbjogRGVwbG95bWVudCBvZiBQcm9tZXRoZXVzIGZvciBt\
ZXRyaWNzIGFuZCBkYXRhIHZpZXcKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBk\
aXNwbGF5TmFtZTogRXBoZW1lcmFsCiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRl\
cGxveSB0aGUgcHJvbWV0aGV1cyBiYXNlIHN0YWNrLCBQcm9tZXRoZXVzIHdpdGggYSBzaWRlY2Fy\
IE9hdXRoLVByb3h5IGFuZCBhbHNvIHRoZSBBbGVydE1hbmFnZXIgc2VydmVyIGJhc2Ugb24gRXBo\
ZW1lcmFsIHN0b3JhZ2UuIFlvdSBjb3VsZCBkZXBsb3kgdGhlIEFkZG9ucyBsaWtlIEdyYXBoYW5h\
LCBBbGVydEJ1ZmZlciBhbmQgTm9kZS1FeHBvcnRlciBpbiB0aGUgc2FtZSBwcm9qZWN0IGp1c3Qg\
Y2hhbmdpbmcgdG8gVHJ1ZSB0aGUgcHJvcGVyIGZpZWxkcyAKICAgICAgY29zdDog4oKsMC4wMAog\
ICAgcGFyYW1ldGVyczoKICAgICAgIyMgT2F1dGgKICAgICAgLSBuYW1lOiBQUk9NRVRIRVVTX1NF\
Q1VSRURfREVQTE9ZTUVOVAogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgZGVmYXVsdDog\
VHJ1ZQogICAgICAgIHR5cGU6IGJvb2wKICAgICAgICB0aXRsZTogRGVwbG95IFByb21ldGhldXMg\
d2l0aCBPYXV0aC1Qcm94eSBzaWRlY2FyCiAgICAgICAgZGlzcGxheV9ncm91cDogR2VuZXJhbCBD\
b25maWcKCiAgICAgICMjIEFsZXJ0TWFuYWdlciBQYXJhbXMKICAgICAgLSBuYW1lOiBTTVRQX0hP\
U1QKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBk\
ZWZhdWx0OiAnbG9jYWxob3N0JwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV8uXSokIgog\
ICAgICAgIHRpdGxlOiBIb3N0bmFtZSBvciBJUCBmb3IgU01UUCBob3N0CiAgICAgICAgZGlzcGxh\
eV9ncm91cDogQWxlcnRNYW5hZ2VyIENvbmZpZwogICAgICAtIG5hbWU6IFNNVFBfUE9SVAogICAg\
ICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIGRlZmF1bHQ6\
IDI1CiAgICAgICAgdGl0bGU6IFBvcnQgbnVtYmVyIG9mIFNNVFAgc2VydmVyCiAgICAgICAgZGlz\
cGxheV9ncm91cDogQWxlcnRNYW5hZ2VyIENvbmZpZwogICAgICAtIG5hbWU6IFNNVFBfRlJPTQog\
ICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1\
bHQ6ICdhbGVydG1hbmFnZXJAZXhhbXBsZS5vcmcnCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1a\
MC05Xy4rLV0rQFthLXpBLVowLTktXSsuW2EtekEtWjAtOS0uXSskIgogICAgICAgIHRpdGxlOiBF\
bWFpbCBmcm9tIGZpZWxkIGZvciBOb3RpZmljYXRpb25zCiAgICAgICAgZGlzcGxheV9ncm91cDog\
QWxlcnRNYW5hZ2VyIENvbmZpZwogICAgICAtIG5hbWU6IFNNVFBfQVVUSF9VU0VSCiAgICAgICAg\
cmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogJ2Fs\
ZXJ0bWFuYWdlcicKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfLi1dKiQiCiAgICAgICAg\
dGl0bGU6IFVzZXJuYW1lIHRvIGJlIGF1dGhlbnRpY2F0ZWQgb24gU01UUCBzZXJ2ZXIKICAgICAg\
ICBkaXNwbGF5X2dyb3VwOiBBbGVydE1hbmFnZXIgQ29uZmlnCiAgICAgIC0gbmFtZTogU01UUF9B\
VVRIX1BBU1MKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfLi1dKiQiCiAgICAgICAgZGVmYXVsdDogJ3Bhc3N3\
b3JkJwogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICB0aXRsZTogUGFzc3dv\
cmQgdG8gYmUgYXV0aGVudGljYXRlZCBvbiBTTVRQIHNlcnZlcgogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEFsZXJ0TWFuYWdlciBDb25maWcKCiAgICAgICMjIEdyYWZhbmEgUGFyYW1zIAogICAgICAt\
IG5hbWU6IERFUExPWV9HUkFGQU5BCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBkZWZh\
dWx0OiBUcnVlCiAgICAgICAgdHlwZTogYm9vbAogICAgICAgIHRpdGxlOiBEZXBsb3kgR3JhZmFu\
YSBzZXJ2ZXIgd2l0aCBQcm9tZXRoZXVzIGFzIGRhdGFzb3VyY2UKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBHcmFmYW5hIENvbmZpZwoKCiAgLSBuYW1lOiBwZXJzaXN0ZW50CiAgICBkZXNjcmlwdGlv\
bjogRGVwbG95bWVudCBvZiBQcm9tZXRoZXVzIGZvciBtZXRyaWNzIGFuZCBkYXRhIHZpZXcKICAg\
IGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogUGVyc2lzdGVudAog\
ICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMgcGxhbiBkZXBsb3kgdGhlIHByb21ldGhldXMgYmFz\
ZSBzdGFjaywgUHJvbWV0aGV1cyB3aXRoIGEgc2lkZWNhciBPYXV0aC1Qcm94eSBhbmQgYWxzbyB0\
aGUgQWxlcnRNYW5hZ2VyIHNlcnZlciBiYXNlIG9uIFBlcnNpc3RlbnQgc3RvcmFnZS4gWW91IGNv\
dWxkIGRlcGxveSB0aGUgQWRkb25zIGxpa2UgR3JhcGhhbmEsIEFsZXJ0QnVmZmVyIGFuZCBOb2Rl\
LUV4cG9ydGVyIGluIHRoZSBzYW1lIHByb2plY3QganVzdCBjaGFuZ2luZyB0byBUcnVlIHRoZSBw\
cm9wZXIgZmllbGRzIAogICAgICBjb3N0OiDigqwwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAj\
IyBPYXV0aAogICAgICAtIG5hbWU6IFBST01FVEhFVVNfU0VDVVJFRF9ERVBMT1lNRU5UCiAgICAg\
ICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBkZWZhdWx0OiBUcnVlCiAgICAgICAgdHlwZTogYm9v\
bAogICAgICAgIHRpdGxlOiBQcm9tZXRoZXVzIFNlY3VyZWQgd2l0aCBPYXV0aC1Qcm94eQogICAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IEdlbmVyYWwgQ29uZmlnCgogICAgICAjIyBQVidzCiAgICAgIC0g\
bmFtZTogUFJPTUVUSEVVU19TVE9SQUdFX1NJWkUKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAg\
ICAgIGRlZmF1bHQ6IDEwCiAgICAgICAgdHlwZTogbnVtYmVyCiAgICAgICAgdGl0bGU6IFByb21l\
dGhldXMgU3RvcmFnZSBTaXplIChHYikKICAgICAgICBkaXNwbGF5X2dyb3VwOiBDb250YWluZXIg\
U3BlY3MKICAgICAgLSBuYW1lOiBQUk9NRVRIRVVTX0FNX1NUT1JBR0VfU0laRQogICAgICAgIHJl\
cXVpcmVkOiBUcnVlCiAgICAgICAgZGVmYXVsdDogMTAKICAgICAgICB0eXBlOiBudW1iZXIKICAg\
ICAgICB0aXRsZTogUHJvbWV0aGV1cyBBbGVydCBNYW5hZ2VyIFN0b3JhZ2UgU2l6ZSAoR2IpCiAg\
ICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNwZWNzCiAgICAgIC0gbmFtZTogUFJPTUVU\
SEVVU19HUkFGQU5BX1NUT1JBR0VfU0laRQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAg\
ZGVmYXVsdDogMTAKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICB0aXRsZTogUHJvbWV0aGV1\
cyBHcmFmYW5hIFN0b3JhZ2UgU2l6ZSAoR2IpCiAgICAgICAgZGlzcGxheV9ncm91cDogQ29udGFp\
bmVyIFNwZWNzCgogICAgICAjIyBBbGVydE1hbmFnZXIgUGFyYW1zCiAgICAgIC0gbmFtZTogU01U\
UF9IT1NUCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgZGVmYXVsdDogJ2xvY2FsaG9zdCcKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfLl0q\
JCIKICAgICAgICB0aXRsZTogSG9zdG5hbWUgb3IgSVAgZm9yIFNNVFAgaG9zdAogICAgICAgIGRp\
c3BsYXlfZ3JvdXA6IEFsZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQX1BPUlQK\
ICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICBkZWZh\
dWx0OiAyNQogICAgICAgIHRpdGxlOiBQb3J0IG51bWJlciBvZiBTTVRQIHNlcnZlcgogICAgICAg\
IGRpc3BsYXlfZ3JvdXA6IEFsZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQX0ZS\
T00KICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBk\
ZWZhdWx0OiAnYWxlcnRtYW5hZ2VyQGV4YW1wbGUub3JnJwogICAgICAgIHBhdHRlcm46ICJeW2Et\
ekEtWjAtOV8uKy1dK0BbYS16QS1aMC05LV0rLlthLXpBLVowLTktLl0rJCIKICAgICAgICB0aXRs\
ZTogRW1haWwgZnJvbSBmaWVsZCBmb3IgTm90aWZpY2F0aW9ucwogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEFsZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQX0FVVEhfVVNFUgogICAg\
ICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6\
ICdhbGVydG1hbmFnZXInCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy4tXSokIgogICAg\
ICAgIHRpdGxlOiBVc2VybmFtZSB0byBiZSBhdXRoZW50aWNhdGVkIG9uIFNNVFAgc2VydmVyCiAg\
ICAgICAgZGlzcGxheV9ncm91cDogQWxlcnRNYW5hZ2VyIENvbmZpZwogICAgICAtIG5hbWU6IFNN\
VFBfQVVUSF9QQVNTCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy4tXSokIgogICAgICAgIGRlZmF1bHQ6ICdw\
YXNzd29yZCcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6IFBh\
c3N3b3JkIHRvIGJlIGF1dGhlbnRpY2F0ZWQgb24gU01UUCBzZXJ2ZXIKICAgICAgICBkaXNwbGF5\
X2dyb3VwOiBBbGVydE1hbmFnZXIgQ29uZmlnCgogICAgICAjIyBHcmFmYW5hIHBhcmFtcwogICAg\
ICAtIG5hbWU6IERFUExPWV9HUkFGQU5BCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBk\
ZWZhdWx0OiBUcnVlCiAgICAgICAgdHlwZTogYm9vbAogICAgICAgIHRpdGxlOiBEZXBsb3kgR3Jh\
ZmFuYSBzZXJ2ZXIgd2l0aCBQcm9tZXRoZXVzIGFzIGRhdGFzb3VyY2UKICAgICAgICBkaXNwbGF5\
X2dyb3VwOiBHcmFmYW5hIENvbmZpZwo="

