FROM ansibleplaybookbundle/apb-base

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY plugins /opt/ansible/plugins
COPY ansible.cfg /etc/ansible/
RUN chmod -R g=u /opt/{ansible,apb}
USER apb

LABEL "com.redhat.apb.version"="1.3.0"
LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBwcm9tZXRoZXVzLWFwYgpkZXNjcmlwdGlvbjogRGVwbG95\
IFByb21ldGhldXMgb24geW91ciBQcm9qZWN0CmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9u\
YWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IFByb21ldGhldXMgKEFQQikKICBpbWFnZVVybDog\
aHR0cHM6Ly9hdmF0YXJzMS5naXRodWJ1c2VyY29udGVudC5jb20vdS8zMzgwNDYyP3M9MjAwJnY9\
NAogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIGxvbmdEZXNjcmlwdGlv\
bjogUHJvbWV0aGV1cyBpcyBhbiBvcGVuLXNvdXJjZSBzeXN0ZW1zIG1vbml0b3JpbmcgYW5kIGFs\
ZXJ0aW5nIHRvb2xraXQgb3JpZ2luYWxseSBidWlsdCBhdCBTb3VuZENsb3VkLiBTaW5jZSBpdHMg\
aW5jZXB0aW9uIGluIDIwMTIsIG1hbnkgY29tcGFuaWVzIGFuZCBvcmdhbml6YXRpb25zIGhhdmUg\
YWRvcHRlZCBQcm9tZXRoZXVzLCBhbmQgdGhlIHByb2plY3QgaGFzIGEgdmVyeSBhY3RpdmUgZGV2\
ZWxvcGVyIGFuZCB1c2VyIGNvbW11bml0eS4gSXQgaXMgbm93IGEgc3RhbmRhbG9uZSBvcGVuIHNv\
dXJjZSBwcm9qZWN0IGFuZCBtYWludGFpbmVkIGluZGVwZW5kZW50bHkgb2YgYW55IGNvbXBhbnku\
IFRvIGVtcGhhc2l6ZSB0aGlzLCBhbmQgdG8gY2xhcmlmeSB0aGUgcHJvamVjdCdzIGdvdmVybmFu\
Y2Ugc3RydWN0dXJlLCBQcm9tZXRoZXVzIGpvaW5lZCB0aGUgQ2xvdWQgTmF0aXZlIENvbXB1dGlu\
ZyBGb3VuZGF0aW9uIGluIDIwMTYgYXMgdGhlIHNlY29uZCBob3N0ZWQgcHJvamVjdCwgYWZ0ZXIg\
S3ViZXJuZXRlcy4KICBzZXJ2aWNlTmFtZTogcHJvbWV0aGV1cwpwbGFuczoKICAtIG5hbWU6IGVw\
aGVtZXJhbAogICAgZGVzY3JpcHRpb246IERlcGxveW1lbnQgb2YgUHJvbWV0aGV1cyBmb3IgbWV0\
cmljcyBhbmQgZGF0YSB2aWV3CiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlz\
cGxheU5hbWU6IEVwaGVtZXJhbAogICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMgcGxhbiBkZXBs\
b3kgdGhlIHByb21ldGhldXMgYmFzZSBzdGFjaywgUHJvbWV0aGV1cyB3aXRoIGEgc2lkZWNhciBP\
YXV0aC1Qcm94eSBhbmQgYWxzbyB0aGUgQWxlcnRNYW5hZ2VyIHNlcnZlciBiYXNlIG9uIEVwaGVt\
ZXJhbCBzdG9yYWdlLiBZb3UgY291bGQgZGVwbG95IHRoZSBBZGRvbnMgbGlrZSBHcmFwaGFuYSwg\
QWxlcnRCdWZmZXIgYW5kIE5vZGUtRXhwb3J0ZXIgaW4gdGhlIHNhbWUgcHJvamVjdCBqdXN0IGNo\
YW5naW5nIHRvIFRydWUgdGhlIHByb3BlciBmaWVsZHMgCiAgICAgIGNvc3Q6IOKCrDAuMDAKICAg\
IHBhcmFtZXRlcnM6CiAgICAgICMjIE9hdXRoCiAgICAgIC0gbmFtZTogUFJPTUVUSEVVU19TRUNV\
UkVEX0RFUExPWU1FTlQKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRlZmF1bHQ6IFRy\
dWUKICAgICAgICB0eXBlOiBib29sCiAgICAgICAgdGl0bGU6IERlcGxveSBQcm9tZXRoZXVzIHdp\
dGggT2F1dGgtUHJveHkgc2lkZWNhcgogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEdlbmVyYWwgQ29u\
ZmlnCgogICAgICAjIyBBbGVydE1hbmFnZXIgUGFyYW1zCiAgICAgIC0gbmFtZTogU01UUF9IT1NU\
CiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVm\
YXVsdDogJ2xvY2FsaG9zdCcKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfLl0qJCIKICAg\
ICAgICB0aXRsZTogSG9zdG5hbWUgb3IgSVAgZm9yIFNNVFAgaG9zdAogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6IEFsZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQX1BPUlQKICAgICAg\
ICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICBkZWZhdWx0OiAy\
NQogICAgICAgIHRpdGxlOiBQb3J0IG51bWJlciBvZiBTTVRQIHNlcnZlcgogICAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IEFsZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQX0ZST00KICAg\
ICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0\
OiAnYWxlcnRtYW5hZ2VyQGV4YW1wbGUub3JnJwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAt\
OV8uKy1dK0BbYS16QS1aMC05LV0rLlthLXpBLVowLTktLl0rJCIKICAgICAgICB0aXRsZTogRW1h\
aWwgZnJvbSBmaWVsZCBmb3IgTm90aWZpY2F0aW9ucwogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEFs\
ZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQX0FVVEhfVVNFUgogICAgICAgIHJl\
cXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6ICdhbGVy\
dG1hbmFnZXInCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy4tXSokIgogICAgICAgIHRp\
dGxlOiBVc2VybmFtZSB0byBiZSBhdXRoZW50aWNhdGVkIG9uIFNNVFAgc2VydmVyCiAgICAgICAg\
ZGlzcGxheV9ncm91cDogQWxlcnRNYW5hZ2VyIENvbmZpZwogICAgICAtIG5hbWU6IFNNVFBfQVVU\
SF9QQVNTCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy4tXSokIgogICAgICAgIGRlZmF1bHQ6ICdwYXNzd29y\
ZCcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6IFBhc3N3b3Jk\
IHRvIGJlIGF1dGhlbnRpY2F0ZWQgb24gU01UUCBzZXJ2ZXIKICAgICAgICBkaXNwbGF5X2dyb3Vw\
OiBBbGVydE1hbmFnZXIgQ29uZmlnCgogICAgICAjIyBHcmFmYW5hIFBhcmFtcyAKICAgICAgLSBu\
YW1lOiBERVBMT1lfR1JBRkFOQQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgZGVmYXVs\
dDogVHJ1ZQogICAgICAgIHR5cGU6IGJvb2wKICAgICAgICB0aXRsZTogRGVwbG95IEdyYWZhbmEg\
c2VydmVyIHdpdGggUHJvbWV0aGV1cyBhcyBkYXRhc291cmNlCiAgICAgICAgZGlzcGxheV9ncm91\
cDogR3JhZmFuYSBDb25maWcKCgogIC0gbmFtZTogcGVyc2lzdGVudAogICAgZGVzY3JpcHRpb246\
IERlcGxveW1lbnQgb2YgUHJvbWV0aGV1cyBmb3IgbWV0cmljcyBhbmQgZGF0YSB2aWV3CiAgICBm\
cmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IFBlcnNpc3RlbnQKICAg\
ICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95IHRoZSBwcm9tZXRoZXVzIGJhc2Ug\
c3RhY2ssIFByb21ldGhldXMgd2l0aCBhIHNpZGVjYXIgT2F1dGgtUHJveHkgYW5kIGFsc28gdGhl\
IEFsZXJ0TWFuYWdlciBzZXJ2ZXIgYmFzZSBvbiBQZXJzaXN0ZW50IHN0b3JhZ2UuIFlvdSBjb3Vs\
ZCBkZXBsb3kgdGhlIEFkZG9ucyBsaWtlIEdyYXBoYW5hLCBBbGVydEJ1ZmZlciBhbmQgTm9kZS1F\
eHBvcnRlciBpbiB0aGUgc2FtZSBwcm9qZWN0IGp1c3QgY2hhbmdpbmcgdG8gVHJ1ZSB0aGUgcHJv\
cGVyIGZpZWxkcyAKICAgICAgY29zdDog4oKsMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAgIyMg\
T2F1dGgKICAgICAgLSBuYW1lOiBQUk9NRVRIRVVTX1NFQ1VSRURfREVQTE9ZTUVOVAogICAgICAg\
IHJlcXVpcmVkOiBUcnVlCiAgICAgICAgZGVmYXVsdDogVHJ1ZQogICAgICAgIHR5cGU6IGJvb2wK\
ICAgICAgICB0aXRsZTogUHJvbWV0aGV1cyBTZWN1cmVkIHdpdGggT2F1dGgtUHJveHkKICAgICAg\
ICBkaXNwbGF5X2dyb3VwOiBHZW5lcmFsIENvbmZpZwoKICAgICAgIyMgUFYncwogICAgICAtIG5h\
bWU6IFBST01FVEhFVVNfU1RPUkFHRV9TSVpFCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAg\
ICBkZWZhdWx0OiAxMAogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHRpdGxlOiBQcm9tZXRo\
ZXVzIFN0b3JhZ2UgU2l6ZSAoR2IpCiAgICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIFNw\
ZWNzCiAgICAgIC0gbmFtZTogUFJPTUVUSEVVU19BTV9TVE9SQUdFX1NJWkUKICAgICAgICByZXF1\
aXJlZDogVHJ1ZQogICAgICAgIGRlZmF1bHQ6IDEwCiAgICAgICAgdHlwZTogbnVtYmVyCiAgICAg\
ICAgdGl0bGU6IFByb21ldGhldXMgQWxlcnQgTWFuYWdlciBTdG9yYWdlIFNpemUgKEdiKQogICAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBTcGVjcwogICAgICAtIG5hbWU6IFBST01FVEhF\
VVNfR1JBRkFOQV9TVE9SQUdFX1NJWkUKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIGRl\
ZmF1bHQ6IDEwCiAgICAgICAgdHlwZTogbnVtYmVyCiAgICAgICAgdGl0bGU6IFByb21ldGhldXMg\
R3JhZmFuYSBTdG9yYWdlIFNpemUgKEdiKQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5l\
ciBTcGVjcwoKICAgICAgIyMgQWxlcnRNYW5hZ2VyIFBhcmFtcwogICAgICAtIG5hbWU6IFNNVFBf\
SE9TVAogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IGRlZmF1bHQ6ICdsb2NhbGhvc3QnCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy5dKiQi\
CiAgICAgICAgdGl0bGU6IEhvc3RuYW1lIG9yIElQIGZvciBTTVRQIGhvc3QKICAgICAgICBkaXNw\
bGF5X2dyb3VwOiBBbGVydE1hbmFnZXIgQ29uZmlnCiAgICAgIC0gbmFtZTogU01UUF9QT1JUCiAg\
ICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogbnVtYmVyCiAgICAgICAgZGVmYXVs\
dDogMjUKICAgICAgICB0aXRsZTogUG9ydCBudW1iZXIgb2YgU01UUCBzZXJ2ZXIKICAgICAgICBk\
aXNwbGF5X2dyb3VwOiBBbGVydE1hbmFnZXIgQ29uZmlnCiAgICAgIC0gbmFtZTogU01UUF9GUk9N\
CiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVm\
YXVsdDogJ2FsZXJ0bWFuYWdlckBleGFtcGxlLm9yZycKICAgICAgICBwYXR0ZXJuOiAiXlthLXpB\
LVowLTlfListXStAW2EtekEtWjAtOS1dKy5bYS16QS1aMC05LS5dKyQiCiAgICAgICAgdGl0bGU6\
IEVtYWlsIGZyb20gZmllbGQgZm9yIE5vdGlmaWNhdGlvbnMKICAgICAgICBkaXNwbGF5X2dyb3Vw\
OiBBbGVydE1hbmFnZXIgQ29uZmlnCiAgICAgIC0gbmFtZTogU01UUF9BVVRIX1VTRVIKICAgICAg\
ICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiAn\
YWxlcnRtYW5hZ2VyJwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV8uLV0qJCIKICAgICAg\
ICB0aXRsZTogVXNlcm5hbWUgdG8gYmUgYXV0aGVudGljYXRlZCBvbiBTTVRQIHNlcnZlcgogICAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IEFsZXJ0TWFuYWdlciBDb25maWcKICAgICAgLSBuYW1lOiBTTVRQ\
X0FVVEhfUEFTUwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV8uLV0qJCIKICAgICAgICBkZWZhdWx0OiAncGFz\
c3dvcmQnCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHRpdGxlOiBQYXNz\
d29yZCB0byBiZSBhdXRoZW50aWNhdGVkIG9uIFNNVFAgc2VydmVyCiAgICAgICAgZGlzcGxheV9n\
cm91cDogQWxlcnRNYW5hZ2VyIENvbmZpZwoKICAgICAgIyMgR3JhZmFuYSBwYXJhbXMKICAgICAg\
LSBuYW1lOiBERVBMT1lfR1JBRkFOQQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgZGVm\
YXVsdDogVHJ1ZQogICAgICAgIHR5cGU6IGJvb2wKICAgICAgICB0aXRsZTogRGVwbG95IEdyYWZh\
bmEgc2VydmVyIHdpdGggUHJvbWV0aGV1cyBhcyBkYXRhc291cmNlCiAgICAgICAgZGlzcGxheV9n\
cm91cDogR3JhZmFuYSBDb25maWcK"

